(function(b){var k=function(a,b){var c=function(a,b,d,e){var f;if(jQuery.isArray(b))jQuery.each(b,function(b,f){d||/\[\]$/.test(a)?e(a,f):c(a+"["+("object"===typeof f?b:"")+"]",f,d,e)});else if(d||"object"!==jQuery.type(b))e(a,b);else for(f in b)c(a+"["+f+"]",b[f],d,e)},e,f=[],m=function(a,c){var e;if(b){if(null===(e=b(a,c)))return;void 0!==e&&(c=e)}c=jQuery.isFunction(c)?c():null==c?"":c;f[f.length]=l(a)+"="+l(c)};if(jQuery.isArray(a)||a.jquery&&!jQuery.isPlainObject(a))jQuery.each(a,function(){m(this.name,
this.value)});else for(e in a)c(e,a[e],void 0,m);return f.join("&").replace(/%20/g,"+")},l=function(a){return"utf-8"!=$page.charset?encodeURIComponent(escape(a).replace(/%u[A-F0-9]{4}/g,function(a){return"&#"+parseInt(a.substr(2),16)+";"})).replace(/%25/g,"%"):encodeURIComponent(a)},u=function(a,d){if(d)return b.get("/post?p="+a+"&mode=editpost",function(a){d(b('form[name="post"]',a).serializeArray())})},h=function(a,d){var c={};if(0==a.length)return!1;for(var e=0;e<d.length&&e<a.length&&!b.isPlainObject(a[e]);e++)c[d[e]]=
a[e];a.length>e&&b.isPlainObject(a[e])&&b.extend(c,a[e]);b.each(c,function(a,e){b.isFunction(e)||(c[a]=function(){return e})});return c},g=function(a,d){var c=!0,e=a.match(/>([^<]*)<br \/><br \/><a href="\/viewtopic\?(?:start=([0-9]+)&amp;)?t=([0-9]+)&amp;topic_name#([0-9]+)">[^<]*<\/a><br \/><br \/><a href="\/f([0-9]+)-([^"]*)">/);e||(e=a.match(/>([^<]*)<br \/><br \/><a href="\/t([0-9]+)-([^"]*)">[^<]*<\/a><br [\\\/]><br [\\\/]><a href="\/f([0-9]+)-([^"]*)">/),e||(e=a.match(/>([^<]*)<br \/><br \/><a href="\/t([0-9]+)-([^"]*)"(?: class="gen")?>[^<]*<\/a>(?:<br [\\\/]><br [\\\/]><a href="(\/(?:forum)?)" class="gen">|<\/p>)/),
e||(e=a.match(/>([^<]*)<br \/><br \/><a href="\/f([0-9]+)-([^"]*)">/)||a.match(/>([^<]*)<br \/><br \/><a href="\/privmsg\?folder=inbox">/)||a.match(/>([^<]*)<br \/><br \/><a href="\/u([0-9]+)">/)||a.match(/<\/h3><\/center><p>([^<]*)<\/p><\/div><h2>/),e||(c=!1,e=a.match(/>([^<]*)<br \/><br \/><a href="\/viewtopic\?f&amp;t&amp;topic_name=topic">/)||a.match(/(?: class="row1"><span class="gen">|<div class="main-content"><p class="center">|<p class="center" style="color: red;">|<div class="box-content error"><p>|<p class="center" style="color: red;"><font color="red">)((?:[^<]*(?:<br \/>)?)+)(?:<\/p>|<\/font><\/p>|<\/span>)/)||
a.match(/(?:<h1 class="page-title">[^<]*<\/h1><p>|<div class="msg">|<\/h1><\/div><div class="main-content message"><p class="message">| align="center"><span class="gen">)([^<]*)(?:<\/p>|<\/div>|<\/span><\/td>)/)||[0,""]))));if(c){c={ok:!0,content:a,message:e[1],forum_id:parseInt(e.slice(-2,-1)[0]),forum_seo_name:e.slice(-1)[0],forum_url:"/f"+e.slice(-2).join("-")};switch(e.length){case 7:b.extend(c,{page:parseInt(e[2]||0),topic_id:parseInt(e[3]),post_id:parseInt(e[4]),post_url:"/t"+e[3]+(e[2]?"p"+
e[2]:"")+"-#"+e[4],topic_url:"/t"+e[3]+"-"});break;case 6:b.extend(c,{topic_id:parseInt(e[2]),topic_seo_name:e[3],topic_url:"/t"+e[2]+"-"+e[3]});break;case 5:delete c.forum_id;delete c.forum_seo_name;delete c.forum_url;b.extend(c,{topic_id:parseInt(e[2]),topic_seo_name:e[3],topic_url:"/t"+e[2]+"-"+e[3]});break;case 3:parseInt(e[2]);case 2:c={ok:!0,content:a,message:e[1]}}d.resolve(c)}else d.reject({ok:c,content:a,message:e[1].replace("<br />","\n")})},n=function(a,d){var c=b.Deferred();d?c.resolve(d):
b.get("/modcp?mode=move&t="+a+"&tid="+$user.tid,function(a){c.resolve(parseInt(b('form[method="post"] [name="f"]',a).val()))});return c},v=function(a,d){var c=b.Deferred();d?c.resolve(d):b.get("/post?p="+a+"&mode=quote",function(a){c.resolve(parseInt(b('form[method="post"] [name="t"]',a).val()))});return c};window.$chat=window.$chat||{};$chat.post=function(){for(var a=["message"],d=h(arguments,a),c=0;c<a.length;c++)if(!(a[c]in d))return;b.post("/chatbox/actions.forum",b.extend(d,{method:"send",archive:0}))};
var p={};b.each(["always","done","fail"],function(a,d){p[d]=function(a){b.each(this._p,function(b,f){f[d](a)});return this}});b.each({$forum:{post:function(){for(var a=["subject","message"],d=h(arguments,a),c=0;c<a.length;c++)if(!(a[c]in d))return;this._p=b.map(this._d,function(a){var c=b.Deferred();b.post("/post",k(b.extend({notify:0},d,{post:1,mode:"newtopic",f:a})),function(a){g(a,c)});return c});return this}},$topic:{post:function(){for(var a=["message"],d=h(arguments,a),c=0;c<a.length;c++)if(!(a[c]in
d))return;this._p=b.map(this._d,function(a){var c=b.Deferred();b.post("/post",k(b.extend({notify:0},d,{post:1,mode:"reply",t:a})),function(a){g(a,c)});return c});return this},remove:function(){this._p=b.map(this._d,function(a){var d=b.Deferred();b.post("/modcp?tid="+$user.tid,{t:a,mode:"delete",confirm:1},function(a){g(a,d)});return d});return this},move:function(a){this._p=b.map(this._d,function(d){var c=b.Deferred();console.log(d);b.post("/modcp?tid="+$user.tid,{tid:$user.tid,new_forum:"f"+a,mode:"move",
t:d,confirm:1},function(a){g(a,c)});return c});return this},trash:function(){this._p=b.map(this._d,function(a){var d=b.Deferred();b.get("/modcp?mode=trash&t="+a+"&tid="+$user.tid,function(a){g(a,d)});return d});return this},merge:function(a){var d=this._d.slice(-1)[0],c=n(d,a);this._p=b.map(this._d.slice(0,-1),function(a){var f=b.Deferred();c.done(function(c){b.post("/merge",{tid:$user.tid,from_topic:a,to_topic:d,submit:1,f:c,confirm:1},function(a){g(a,f)})});return f});return this},lock:function(){this._p=
b.map(this._d,function(a){var d=b.Deferred();b.get("/modcp?mode=lock&t="+a+"&tid="+$user.tid,function(a){g(a,d)});return d});return this},unlock:function(){this._p=b.map(this._d,function(a){var d=b.Deferred();b.get("/modcp?mode=unlock&t="+a+"&tid="+$user.tid,function(a){g(a,d)});return d});return this}},$post:{remove:function(){this._p=b.map(this._d,function(a){var d=b.Deferred();b.post("/post",{p:a,mode:"delete",confirm:""},function(a){g(a,d)});return d});return this},change:function(){var a=h(arguments,
["message"]);this._p=b.map(this._d,function(d){var c=b.Deferred();u(d,function(d){b.post("/post",k(d,function(b,c){if(b in a)return a[b](c)})+"&post=1",function(a){g(a,c)})});return c});return this},split:function(a,d,c,e){if(!this._d)return this;var f=b.Deferred(),h=this._d;v(this._d[0],c).done(function(c){n(c,d).done(function(d){d={subject:a,new_forum_id:"f"+d,post_id_list:h,t:c,mode:"split"};d["split_type_"+(e?"beyond":"all")]=1;var f=b.Deferred();b.post("/modcp?tid="+$user.tid,k(d),function(a){g(a,
f)})})});this._p=[f];return this},split_beyond:function(a,b,c){return this.split(a,b,c,!0)}},$user:{pm:function(){for(var a=["subject","message"],d=h(arguments,a),c=0;c<a.length;c++)if(!(a[c]in d))return;var e=b.Deferred();b.post("/privmsg",k(b.extend(d,{username:this._d,mode:"post",post:1})),function(a){g(a,e)});this._p=[e];return this},ban:function(){var a=h(arguments,["ban_user_date","ban_user_reason"]);this._p=b.map(this._d,function(d){var c=b.Deferred();b.post("/modcp?tid="+$user.tid,k(b.extend(a,
{tid:$user.tid,confirm:1,mode:"ban",user_id:d})),function(a){g(a,c)});return c});return this},unban:function(){var a=b.Deferred();b.post("/admin/index.forum?part=users_groups&sub=users&mode=ban_control&extended_admin=1&tid="+$user.tid,{users_to_unban:this._d,unban_users:1},function(b){g(b,a)});this._p=[a];return this}}},function(a,d){window[a]=function(){var c=b.makeArray(arguments);1==c.length&&b.isArray(c[0])&&(c=c[0]);return b.extend(window[a]||{},p,d,{_d:c,_p:[]})}});window.$page=window.$page||
{};window.$user=window.$user||{};var q=function(){var a=location.pathname;return/^\/t[1-9][0-9]*(p[1-9][0-9]*)?-/.test(a)?"topic":/^\/f[1-9][0-9]*(p[1-9][0-9]*)?-/.test(a)?"forum":b("#i_icon_mini_index").parent().attr("href")==a?"index":/^\/c[1-9][0-9]*-/.test(a)?"category":""};$page.type=q();b(function(){$page.type=q()});$page.id=function(){var a=location.pathname,b=a.match(/^\/[tfc]([1-9][0-9]*)(p[1-9][0-9]*)?-/);b||(b=a.match(/^\/u([1-9][0-9]*)[a-z]*$/));return b?+b[1]:0}();$page.num=function(){var a=
location.pathname.match(/^\/[tf][1-9][0-9]*(p[1-9][0-9]*)-/);return a?+a[1]:0}();$page.charset=(document.charset?document.charset:document.characterSet).toLowerCase();var r=function(){return b("input[name=tid]:first").val()||(b("a[href*='&tid=']:first").attr("href")||"").replace(/^.*&tid=([a-z0-9]*)?.*$/,"$1")};$user.tid=r();b(function(){$user.tid=r()});$user.id=parseInt(((my_getcookie("fa_"+location.host.replace(/\./g,"_")+"_data")||"").match(/"userid";(?:s:[0-9]+:"|i:)([0-9]+)/)||[0,-1])[1]);$user.guest=
-1==$user.id;var t=function(){var a=_userdata||{};$user.name=a.username;$user.admin=1==a.user_level;$user.mod=0<a.user_level;$user.lang=a.lang;$user.avatar=a.avatar;$user.num_post=a.user_posts;$user.num_pm=a.user_nb_privmsg;$user.num_reputation=a.point_reputation;$user.rank=window._lang?_lang.rank_title:""};t();b(t)})(jQuery);
